<!-- Barra de Ferramentas -->
<app-toolbar
  (toggleSearchEvent)="onToggleSearch()"
  (openAddDialogEvent)="openAddDialog()">
</app-toolbar>

<!-- Barra de Pesquisa -->
<div *ngIf="showSearchBar" class="search-container">
  <form [formGroup]="searchForm" class="search-form">
    <input
      formControlName="searchTerm"
      type="text"
      placeholder="Pesquisar por nome, descrição, preço..."
      class="search-input"
    />
  </form>
</div>

<!-- Lista de Produtos -->
<div *ngIf="filteredProducts.length > 0; else noProducts">
  <h2>Lista de Produtos</h2>

  <!-- Controle de Itens por Página -->
  <div class="pagination-controls">
    <label for="itemsPerPage">Itens por página:</label>
    <select id="itemsPerPage" (change)="updateItemsPerPage($event)">
      <option value="3">3</option>
      <option value="5">5</option>
      <option value="10">10</option>
    </select>
  </div>

  <!-- Exibição da Lista de Produtos -->
  <ul>
    <li *ngFor="let product of paginatedProducts" class="product-item"
        (mouseenter)="product.showActions = true" (mouseleave)="product.showActions = false">
      <h3>{{ product.name }}</h3>
      <p>ID: {{ product.id }}</p>
      <p>Descrição: {{ product.description }}</p>
      <p><strong>Preço por Unidade: </strong>R${{ (product.priceforlote / product.quantity) | number:'1.2-2' }}</p>
      <p><strong>Preço por Lote: </strong>R${{ product.priceforlote | number:'1.2-2' }}</p>
      <p><strong>Quantidade por Lote: </strong>{{ product.quantity }}</p>

      <!-- Botões de Ação -->
      <button *ngIf="product.showActions" class="delete-button" (click)="confirmDelete(product.id)">X</button>
      <button *ngIf="product.showActions" class="edit-button" (click)="openEditDialog(product)">✏️</button>
    </li>
  </ul>

  <!-- Botões de Paginação -->
  <div class="pagination">
    <button
      *ngFor="let page of [].constructor(totalPages()); let i = index"
      [class.active]="i + 1 === currentPage"
      (click)="changePage(i + 1)">
      {{ i + 1 }}
    </button>
  </div>
</div>

<!-- Caso não haja produtos -->
<ng-template #noProducts>
  <p>Nenhum produto disponível no momento.</p>
</ng-template>

<!-- Mensagem de Erro -->
<div *ngIf="errorMessage" class="error-message">
  {{ errorMessage }}
</div>

<!-- Indicador de Carregamento -->
<div *ngIf="loading" class="loading">
  Carregando produtos...
</div>
